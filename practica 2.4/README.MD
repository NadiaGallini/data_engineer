Практические задания. SQL.

Чтобы успешно справиться с данным практическим заданием, вам необходимо выполнить как минимум задания 1-4 практики в теме 2.3 "Реляционные базы данных: PostgreSQL", но желательно сделать, конечно же, все.

Теперь мы знакомы с гораздо большим перечнем операторов языка SQL и это дает нам дополнительные возможности для анализа данных. Выполните следующие запросы:

Попробуйте вывести не просто самую высокую зарплату во всей команде, а вывести именно фамилию сотрудника с самой высокой зарплатой.

Попробуйте вывести фамилии сотрудников в алфавитном порядке

Рассчитайте средний стаж для каждого уровня сотрудников

Выведите фамилию сотрудника и название отдела, в котором он работает

Выведите название отдела и фамилию сотрудника с самой высокой зарплатой в данном отделе и саму зарплату также.

*Выведите название отдела, сотрудники которого получат наибольшую премию по итогам года. Как рассчитать премию можно узнать в последнем задании предыдущей домашней работы

*Проиндексируйте зарплаты сотрудников с учетом коэффициента премии. Для сотрудников с коэффициентом премии больше 1.2 – размер индексации составит 20%, для сотрудников с коэффициентом премии от 1 до 1.2 размер индексации составит 10%. Для всех остальных сотрудников индексация не предусмотрена.

***По итогам индексации отдел финансов хочет получить следующий отчет: вам необходимо на уровень каждого отдела вывести следующую информацию:

Название отдела

Фамилию руководителя

Количество сотрудников

Средний стаж

Средний уровень зарплаты

Количество сотрудников уровня junior

Количество сотрудников уровня middle

Количество сотрудников уровня senior

Количество сотрудников уровня lead

Общий размер оплаты труда всех сотрудников до индексации

Общий размер оплаты труда всех сотрудников после индексации

Общее количество оценок А

Общее количество оценок B

Общее количество оценок C

Общее количество оценок D

Общее количество оценок Е

Средний показатель коэффициента премии

Общий размер премии.

Общую сумму зарплат(+ премии) до индексации

Общую сумму зарплат(+ премии) после индексации(премии не индексируются)

Разницу в % между предыдущими двумя суммами(первая/вторая)

Задача со (*) - для обучающихся в группе 1Т ИД когорта Pro.

По итогам работы вам необходимо запушить код запросов к БД в отдельный репозиторий (github/gitlab) и приложить ссылку.'